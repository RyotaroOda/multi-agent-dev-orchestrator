# 個人xマルチエージェント運用最適化仕様書 v0.2-draft

## 1. 目的

個人開発者1名が、複数エージェントを安全かつ継続的に使い分けられるよう、運用負荷と判断負荷を下げる標準プロファイルを定義する。

## 2. 前提

- 判定体制は `AIプランナーエージェント（評価支援） + ユーザー（最終判定）` の2者運用とする。
- セキュリティ優先順位 `A:漏えい防止 > B:ホスト保護 > C:課金回避` を崩さない。
- 既存の SoT は GitHub Issue を維持する。
- 企画フェーズでは実装コード作成・依存追加・ビルド/テスト実行を行わない。

## 3. スコープ

- 個人運用向けのWIP制御
- 稼働モード（集中/並列/復旧）の切替ルール
- セッション入出力の標準化
- 個人運用での監査チェック簡素化
- 個人運用特有のリスク監視指標

## 4. 運用プロファイル（個人向け）

### 4.1 WIP上限

- `running` 同時Issue上限は `2` とする。
- `blocked` が1件でも24時間超過した場合、新規 `queued` を停止する。
- 例外的に3件目へ進む場合は、事前にADRで理由と期限を記録する。

### 4.2 稼働モード

| モード | 適用条件 | 上限 | 目的 |
| --- | --- | --- | --- |
| Focus | 高優先度Issueを1件で進める時 | `running=1` | コンテキスト切替を最小化 |
| Parallel | 独立Issueを並行処理する時 | `running<=2` | 待ち時間の吸収 |
| Recovery | `blocked` の復帰判断が必要な時 | `running<=1` | 停滞解消と安全確認 |

## 5. セッション契約（個人向け）

### 5.1 開始時に固定する入力

- 目的（今回終える論点）
- 制約（触れてはいけない範囲）
- 終了条件（done判定の観測条件）

### 5.2 終了時に必ず出力する項目

- `結論`
- `根拠`
- `未決事項`
- `次アクション（担当/期限）`

### 5.3 台帳更新ルール

- 企画判断: `plan/意思決定ログ.md`
- タスク追加/状態変更: `plan/バックログ.md`
- リスク追加/状態変更: `plan/リスク登録簿.md`

## 6. 個人運用の監査簡素化ルール

- 日次で確認する監査対象を以下に固定する:
  - `run_id` 追跡可否
  - `app_slug` 一致（bot主体）
  - 例外ラベル4項目（理由/適用範囲/失効日/承認者）
  - `blocked_reason` の語彙一致
- 監査不備が1件でも見つかった場合は `Recovery` モードへ遷移し、新規 `queued` を停止する。

## 7. 個人運用KPI（最小セット）

| KPI | 定義 | 目標（初期） |
| --- | --- | --- |
| Active WIP | `running` Issue数 | 常時 `<=2` |
| Blocked Aging | `blocked` 継続時間 | 24時間以内に一次判断 |
| Context Switch | 1日あたりの着手Issue切替回数 | 3回以内 |
| 台帳遅延 | 判断後に台帳反映されるまでの時間 | 同日中 |

## 8. 関連テンプレート

- `plan/templates/個人xマルチエージェント_TaskBriefテンプレート.md`
- `plan/templates/個人xマルチエージェント_PRチェックリスト.md`
- `plan/templates/個人xマルチエージェント_日次レビュー.md`
- `plan/templates/M8再Go-No-Go入力テンプレート.md`

## 9. 初期プランニング手順（個人向け）

### 9.1 フェーズ1: 前提合わせ

- Goal/Non-goals/制約/不明点を明示する。
- AIに確認質問を優先度順で列挙させる。

### 9.2 フェーズ2: 選択肢比較

- AIに2〜3案の比較（影響範囲/リスク/テスト方針）を作成させる。
- ユーザーが優先順位（速度/安全/拡張性）に基づき1案を確定する。

### 9.3 フェーズ3: 実行分割

- `Task Brief` とタスク分割（3〜7）を確定する。
- 各タスクの担当範囲（触るファイル）と依存関係を固定する。
- マージ順序（統合キュー）を先に決める。

## 10. 関連仕様

- `plan/specs/20_GitHub前提コミットPRマージ完了運用仕様.md`
- `plan/specs/21_起動時コンテキストファイル運用仕様.md`

## 11. 未決事項

- なし（v0.2の個人運用最適化スコープとして確定）。
