# 初回開発着手ハンドオーバー仕様書 v0.2-draft

## 1. 目的

`13_機能別開発者実装準備仕様.md` を起点に、初回着手3Issue（`#5/#6/#7`）へ引き渡す入力セット、順序、更新ルールを固定し、Go後の実装開始で解釈差分が出ない状態を作る。

## 2. 前提

- 現在フェーズは企画であり、実装コード作成・依存追加・ビルド/テスト実行は行わない。
- 標準実行環境は Apple Mac Studio M3 Ultra（メモリ512GB）とする。
- NVIDIA DGX Spark は将来対応（P2）として扱い、初回着手スコープには含めない。
- 判定体制は `AIプランナーエージェント + ユーザー` の2者運用とし、参加確認・連絡先確認は行わない。
- セキュリティ優先順位 `A:漏えい防止 > B:ホスト保護 > C:課金回避` を崩さない。

## 3. 対象Issueと機能対応

| 順序 | Issue | 論点 | 主機能ID | 主要参照仕様 |
| --- | --- | --- | --- | --- |
| 1 | `#5` DEV-001 | 状態遷移基盤の確立 | `F-1301`, `F-1303` | `13`, `15`, `16`, `01`, `03` |
| 2 | `#6` DEV-002 | ポリシー+品質ゲート統合 | `F-1305`, `F-1306` | `13`, `15`, `16`, `05`, `06`, `11` |
| 3 | `#7` DEV-003 | 完全性検証+GitHub App PR接続 | `F-1307`, `F-1311` | `13`, `15`, `16`, `07`, `14` |

## 4. 共通ハンドオーバー入力セット

1. 一次参照
   - `13_機能別開発者実装準備仕様.md`
   - `15_機能別イベント契約と判定語彙仕様.md`
   - `16_初回開発Issue候補とDoR詳細.md`
   - 本仕様（`17_初回開発着手ハンドオーバー仕様.md`）
2. 判定根拠
   - `plan/M4本判定会_記録_2026-02-21.md`
   - `plan/意思決定ログ.md`（`ADR-043`）
3. 監査台帳
   - `plan/バックログ.md`
   - `plan/リスク登録簿.md`

## 5. Issue別着手仕様

### 5.1 DEV-001（Issue #5）

- 着手前固定条件:
  - DoRが充足で確定済み（`ADR-040`）。
  - `queued/running/blocked/completed` の語彙は `15` の定義を正本とする。
- 着手開始時の確認:
  - `blocked_reason` 命名規約に未定義語がない。
  - `run_id` 発行と復帰時再発行ルールが仕様上で矛盾しない。
- 受け渡し成果物（企画→実装）:
  - 状態遷移定義のチェック観点一覧
  - blocked復帰判定の入力項目一覧
- 参照追加:
  - `18_DEV-001状態遷移と復帰契約仕様.md`

### 5.2 DEV-002（Issue #6）

- 着手前固定条件:
  - DoRが充足で確定済み（`ADR-041`）。
  - policy例外ラベルは4項目（理由/適用範囲/失効日/承認者）必須。
- 着手開始時の確認:
  - `allow/deny/blocked` の判定語彙が `15` と一致する。
  - `required:test/lint/typecheck/policy-diff` の必須チェック定義に欠落がない。
- 受け渡し成果物（企画→実装）:
  - 例外ラベル有効性チェック観点
  - fail-closed適用条件の確認表
- 参照追加:
  - `19_DEV-002ポリシー品質ゲート連動契約仕様.md`

### 5.3 DEV-003（Issue #7）

- 着手前固定条件:
  - DoRが充足で確定済み（`ADR-042`）。
  - PR作成主体は GitHub App（bot）固定。
- 着手開始時の確認:
  - `SHA-256` 検証と `run_id` 紐付けが同時成立する仕様になっている。
  - installation token の短命運用と鍵ローテーション方針が矛盾しない。
- 受け渡し成果物（企画→実装）:
  - 完全性検証の入力・出力契約
  - PR作成時の監査記録項目（`run_id`/`app_slug`）

## 6. 着手順固定ルール

- 標準順序は `#5 -> #6 -> #7` とする。
- 順序変更が必要な場合は、着手前に `plan/意思決定ログ.md` へADR追記を必須とする。
- 順序変更時は `plan/バックログ.md` と `plan/M4本判定会_記録_2026-02-21.md` を同時更新する。

## 7. 監査更新ルール（企画フェーズ）

- 企画判断の更新先は `plan/意思決定ログ.md` を正本とする。
- 新規タスクまたは状態変更は `plan/バックログ.md` に反映する。
- 新規リスクまたは状態変更は `plan/リスク登録簿.md` に反映する。
- 例外ラベル運用は `11_policy例外ラベル運用規程.md` の4項目必須を維持する。

## 8. 未決事項

- なし（初回着手3Issueの順序・DoR・更新ルールは確定済み）。
