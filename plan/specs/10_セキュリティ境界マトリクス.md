# セキュリティ境界マトリクス v0.2-draft

## 1. 目的

優先順位 `A:漏えい防止 > B:ホスト保護 > C:課金回避` を、実行可能な禁止事項と例外条件に分解する。

## 2. 境界レイヤー

| レイヤー | 既定 | 禁止事項 | 例外条件 |
| --- | --- | --- | --- |
| LLM送信 | ローカル推論のみ許可 | コード全文/秘密情報/詳細ログの外部送信 | `policy:cloud-llm=allow` + 理由/適用範囲/失効日/承認者 |
| ネットワーク | allowlistのみ通信可 | allowlist外への外向き通信 | 運用承認 + 期限付き例外 + 監査ログ |
| ホスト境界 | コンテナ隔離 | ホスト書き込みマウント、危険権限付与 | 明示allowlist + 期限付き |
| CI/品質 | 必須チェック固定 | テスト無効化、CI改変による迂回 | `policy:allow-test-change` / `policy:allow-ci-change` + 追認 |
| ログ | 最小ログ収集 | プロンプト本文/応答本文/コード全文保存 | ローカル短期保持 + マスク + 承認 |

## 3. 優先度別の強制度

### A（漏えい防止）

- fail-closed を強制（判定不能時は deny）
- 例外は必ず期限付き
- 例外利用履歴を監査ログに保存

### B（ホスト保護）

- 1 Issue / 1 Run のコンテナ隔離
- リソース制限必須（CPU/メモリ/PIDs/ディスク）
- Run終了時の破棄失敗はアラート

### C（課金回避）

- ローカル推論優先
- クラウド送信は例外時のみ
- モデルロード/並列制御で過剰利用を抑制

## 4. 例外適用の最小要件

- 理由（何を満たすためか）
- 適用範囲（Issue/ステージ/対象ファイル）
- 失効日（YYYY-MM-DD）
- 承認者（ロールまたは個人名）

欠落があれば例外は無効とする。

## 5. 受け入れ条件

- 禁止事項と例外条件がレイヤー別に一意に参照できる
- 例外の最低必須項目が定義されている
- A/B/C優先度に応じた強制度が明記されている

## 6. 未決事項

- なし（v0.2範囲で確定済み）。
